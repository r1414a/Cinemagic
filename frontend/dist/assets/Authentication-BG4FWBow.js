import{b as V,k as T,n as D,j as e,s as G,r as o,d as $,m as H,N as J}from"./index-B8z_zBDs.js";import{t as q}from"./ticketlogo-DARbjQod.js";import{a as w}from"./allapis-VSAyny7H.js";import{G as C,i as Z}from"./index-CDTVc3k6.js";const K="/assets/authImage-CJsF8MJJ.jpeg";function U(){const a=V(),c=T(),n=async({code:u})=>{const x=await w("/api/auth/google","POST",{authorization_code:u},"Error in google authentication.",m=>{a(G(m.user)),c("/")});console.log(x)},i=D({onSuccess:n,onError:n,flow:"auth-code"});return e.jsx(e.Fragment,{children:e.jsx("button",{className:"h-12 cursor-pointer bg-dyellow text-black font-semibold rounded-md w-full",onClick:()=>i(),children:"Sign in with Google ðŸš€"})})}function k({isLoading:a,text:c}){return e.jsx(e.Fragment,{children:a?[...Array(5)].map((n,i)=>e.jsx("div",{style:{animationDelay:`${i*.5}s`},className:"h-2.5 w-2.5 rounded-full bg-blue animate-bounce"},i)):c})}function W(a){return C({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16.707 2.293A.996.996 0 0 0 16 2H8a.996.996 0 0 0-.707.293l-5 5A.996.996 0 0 0 2 8v8c0 .266.105.52.293.707l5 5A.996.996 0 0 0 8 22h8c.266 0 .52-.105.707-.293l5-5A.996.996 0 0 0 22 16V8a.996.996 0 0 0-.293-.707l-5-5zM13 17h-2v-2h2v2zm0-4h-2V7h2v6z"},child:[]}]})(a)}function Q(a){return C({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M400 48H112a64.07 64.07 0 0 0-64 64v288a64.07 64.07 0 0 0 64 64h288a64.07 64.07 0 0 0 64-64V112a64.07 64.07 0 0 0-64-64zm-35.75 138.29-134.4 160a16 16 0 0 1-12 5.71h-.27a16 16 0 0 1-11.89-5.3l-57.6-64a16 16 0 1 1 23.78-21.4l45.29 50.32 122.59-145.91a16 16 0 0 1 24.5 20.58z"},child:[]}]})(a)}function S({type:a,message:c,closeToastFunction:n}){return e.jsxs("div",{id:"toast-default",className:"absolute right-0 bottom-10 md:right-10 z-30 flex items-center w-full max-w-xs p-3 md:p-4 text-black bg-white rounded-md shadow-sm animate-fadeIn",role:"alert",children:[e.jsx("div",{className:`inline-flex items-center justify-center shrink-0 w-8 h-8 ${a==="success"?"text-green-600":"text-red-600"} bg-dyellow rounded-lg`,children:a==="success"?e.jsx(Q,{}):e.jsx(W,{})}),e.jsx("div",{className:"ms-3 text-sm font-medium",children:c}),e.jsxs("button",{type:"button",onClick:()=>n(!1),className:"ms-auto -mx-1.5 -my-1.5 bg-white text-gray-600 hover:text-gray-900 rounded-md p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8 cursor-pointer hover:rotate-180 transition-transform duration-500 ease-in-out","data-dismiss-target":"#toast-default","aria-label":"Close",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})})]})]})}function ae(){const[a,c]=o.useState(""),n=$(),[i]=H(n.search),u=i.get("email"),x=i.get("token"),[m,f]=o.useState([]),j=T(),P=o.useRef(),_=o.useRef(),E=o.useRef(),A=o.useRef(),O=o.useRef(),M=o.useRef(),[y,h]=o.useState(!1),[L,p]=o.useState(!0),[z,b]=o.useState(!1),[X,v]=o.useState(""),[B,F]=o.useState(""),g=[P,_,E,A,O,M],N=async r=>{h(!0),r.preventDefault();const t=await w("/api/auth/send-otp","POST",a?{email:a}:{userEmail:u},"Error while sending otp for verification.",s=>{h(!1),p(!0),v("OTP sent successfully."),j(`/authentication/verify?token=${s.token}&email=${a}`)});console.log(t)},R=async r=>{h(!0),r.preventDefault();const t=await w("/api/auth/verify-otp","POST",{token:x,otp:m,userEmail:u},"Error while verifying otp.",s=>{p(!0),v("OTP verification successfull."),j("/")},s=>{b(!0),F(s.message)},()=>{h(!1)});console.log(t)},I=(r,t)=>{console.log("handle",r);const s=r.target.value.replace(/[^0-9]/g,"");s===""?console.log("not a digit"):(t!=5&&g[t+1].current.focus(),f(d=>{const l=[...d];return l[t]=s,l}))};return console.log(m),e.jsxs("section",{className:"flex flex-col md:flex-row h-screen",children:[e.jsx("div",{className:"relative w-full md:w-1/2 h-[35%] md:h-full rounded-b-full md:rounded-e-full md:rounded-bl-none",style:{backgroundImage:`url(${K})`,backgroundPosition:"center",backgroundSize:"contain"},children:e.jsx(J,{to:"/",className:"absolute -bottom-5 left-5 md:bottom-[100%] md:left-[100%] md:right-0 md:top-5",children:e.jsxs("button",{className:"flex gap-2  items-center text-white hover:text-dyellow cursor-pointer",children:[e.jsx(Z,{}),"Home"]})})}),e.jsx("div",{className:"w-full flex flex-col justify-center items-center md:w-1/2 h-[65%] md:h-full bg-blue px-8 md:px-12 lg:px-24 xl:px-32 2xl:px-40",children:n.pathname==="/authentication"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8 md:mb-16 flex gap-2 justify-center items-center",children:[e.jsx("img",{src:q,alt:"website logo",className:"w-8"}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-center text-white",children:"Cinemagic"})]}),e.jsxs("form",{onSubmit:N,className:"my-4 w-full",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none",children:e.jsxs("svg",{className:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 16",children:[e.jsx("path",{d:"m10.036 8.278 9.258-7.79A1.979 1.979 0 0 0 18 0H2A1.987 1.987 0 0 0 .641.541l9.395 7.737Z"}),e.jsx("path",{d:"M11.241 9.817c-.36.275-.801.425-1.255.427-.428 0-.845-.138-1.187-.395L0 2.6V14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2.5l-8.759 7.317Z"})]})}),e.jsx("input",{type:"email",value:a,onChange:r=>c(r.target.value),id:"input-group-1",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full ps-10 h-12",placeholder:"Enter your email",required:!0})]}),e.jsx("button",{type:"submit",className:"flex items-center justify-center gap-2 w-full bg-dyellow h-12 font-semibold rounded-md cursor-pointer",children:e.jsx(k,{isLoading:y,text:"Continue"})})]}),e.jsxs("div",{className:"my-2 w-full flex items-center gap-2",children:[e.jsx("div",{className:"h-0.5 w-1/2 bg-white"}),e.jsx("p",{className:"text-white font-semibold text-sm",children:"OR"}),e.jsx("div",{className:"h-0.5 w-1/2 bg-white"})]}),e.jsx("div",{className:"w-full mt-4",children:e.jsx(U,{})})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-white text-center text-xl md:text-3xl font-bold",children:"OTP Verification"}),e.jsxs("p",{className:"text-center text-white my-3 md:my-4",children:["Enter OTP code sent on"," ",e.jsx("span",{className:"font-semibold",children:u})]}),e.jsx("div",{className:"my-2",children:e.jsxs("form",{onSubmit:R,className:" space-y-5",children:[e.jsx("div",{className:"flex gap-2",children:[...Array(6)].map((r,t)=>e.jsx("input",{ref:g[t],name:t,type:"text",id:"otp-input",onChange:s=>I(s,t),className:"bg-gray-50 border border-gray-300 text-gray-900 text-lg rounded-md text-center block w-full py-3.5 focus:ring-2 focus:ring-dyellow",required:!0,maxLength:1,size:1,max:1,autoFocus:t===0,pattern:"[0-9]{1}",inputMode:"numeric",onInput:s=>{s.target.value=s.target.value.replace(/[^0-9]/g,"")},onKeyDown:s=>{if(console.log(t),s.key==="Backspace"&&t>=0)if(t<5){if(s.target.value===""&&t===0)return;s.target.value===""&&t>0&&g[t-1].current.focus(),f(d=>{const l=[...d];return l[t]="",l})}else s.target.value="",g[t-1].current.focus(),f(d=>{const l=[...d];return l[t]="",l[t-1]="",l})}},t))}),e.jsx("div",{className:"w-full",children:e.jsx("button",{type:"submit",className:"flex items-center justify-center gap-2 bg-dyellow font-medium rounded-md cursor-pointer h-12 w-full",children:e.jsx(k,{isLoading:y,text:"Verify & Proceed"})})})]})}),e.jsxs("div",{className:"my-4 space-y-2 text-center",children:[e.jsx("p",{className:"text-white",children:"Didn't receive OTP code ?"}),e.jsx("button",{onClick:N,className:"text-dyellow text-center cursor-pointer font-medium",children:"Resend Code"})]})]})}),L&&e.jsx(S,{closeToastFunction:p,type:"success",message:"OTP sent successfully."}),z&&e.jsx(S,{closeToastFunction:b,type:"error",message:B})]})}export{ae as default};
