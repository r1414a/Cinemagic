import{g as Y,b as I,k as R,r as d,u as O,l as T,f as V,j as e,L as X}from"./index-B8z_zBDs.js";import{h as s}from"./moment-C5S46NFB.js";import{F as $,M as A}from"./MovieDuration-YiszCoLB.js";import{c as _,f as F}from"./index-CDTVc3k6.js";import{a as B}from"./allapis-VSAyny7H.js";import"./index-CH5ZUpk5.js";const L={Mumbai:[{name:"PVR Phoenix",chain:"PVR",location:"Lower Parel"},{name:"INOX R-City",chain:"INOX",location:"Ghatkopar"},{name:"Cinepolis Andheri",chain:"Cinepolis",location:"Andheri West"},{name:"IMAX Wadala",chain:"IMAX",location:"Wadala"}],Delhi:[{name:"PVR City",chain:"PVR",location:"Saket"},{name:"INOX Nehru Place",chain:"INOX",location:"Nehru Place"},{name:"Cinepolis Janakpuri",chain:"Cinepolis",location:"Janakpuri"}],Bengaluru:[{name:"PVR Orion Mall",chain:"PVR",location:"Rajajinagar"},{name:"INOX Garuda Mall",chain:"INOX",location:"Ashok Nagar"},{name:"Cinepolis Banaswadi",chain:"Cinepolis",location:"Banaswadi"}],Hyderabad:[{name:"PVR Forum Sujana",chain:"PVR",location:"Kukatpally"},{name:"INOX GVK One",chain:"INOX",location:"Banjara Hills"}],Pune:[{name:"PVR Pavillion",chain:"PVR",location:"Senapati Bapat Road"},{name:"INOX Camp",chain:"INOX",location:"Camp"},{name:"Cinepolis",chain:"Cinepolis",location:"Seasons Mall"},{name:"PVR Phoenix",chain:"PVR",location:"Phoenix Market City"}]};function K(){const w=Y().id,x=I(),b=R(),u=d.useRef({}),{details:t,isLoading:y}=O(a=>a.movie),{selectedCity:i,setSelectedCity:N,selectedDate:n,selectedTheater:r,selectedTime:m,setSelectedDate:p,setSelectedTheater:v,setSelectedTime:j,setShowtimeID:D,showtimeID:S}=T(),[k,C]=d.useState([]),[h,g]=d.useState(null),f=async a=>{if(console.log(a),a===n&&h!=null)return;if(u.current[a]){p(a),g(u.current[a]);return}p(a);const o=await B("/api/movies/getShowtimeforAllDates","POST",{date:a,movieID:t[0].id},"Error while getting showtimes for all dates.",l=>{const c=l.showtime_arr.sort();u.current[a]=c,g(c)});console.log(o)};if(d.useEffect(()=>{t.length&&f(n)},[t]),d.useEffect(()=>{x(V(w));function a(){const o=[];for(let l=0;l<5;l++){const c=s().add(l,"days");o.push({date:c.format("YYYY-MM-DD"),dateUnix:c.unix()})}C(o)}a()},[x]),t.length===0||y)return e.jsx(X,{});const P=a=>{if(a>s().unix())return;console.log("running isTimeSlotPast");const o=s.unix(n).format("YYYY-MM-DD"),l=s().format("YYYY-MM-DD");return o===l?s().unix()>a:!1},M=()=>{b(`/movie/book/${t[0].id}/seatLayout?showtimeID=${S}&theater=${JSON.stringify(r)}&city=${i}&time=${m}&date=${n}`)};return console.log("selectedCity",i,"selecteTheater",r,"selectedTime",m,"selectedDate",n,"timeslots arr",h),e.jsx(e.Fragment,{children:e.jsxs("section",{className:"relative min-h-screen flex items-center justify-center",style:{backgroundImage:`url(http://image.tmdb.org/t/p//original${t[0].backdrop_path})`,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center"},children:[e.jsx("div",{className:"absolute w-full z-10 h-full bg-radial-[at_50%_50%] from-transparent to-black to-0% opacity-[0.8] "}),e.jsx("div",{className:"relative w-full h-full flex items-center justify-center z-30",children:e.jsxs("div",{className:"relative w-full max-w-6xl px-6 lg:px-10 py-32 rounded-md flex flex-col md:flex-row gap-10",children:[e.jsxs("div",{className:"w-full md:w-[40%] flex flex-col items-center justify-center space-y-3",children:[e.jsx("h1",{className:"text-4xl xl:text-5xl text-center font-semibold text-white",children:t[0].original_title}),e.jsx("div",{children:e.jsx("img",{src:`http://image.tmdb.org/t/p//w185${t[0].poster_path}`,className:"rounded-md",alt:"movie poster"})}),e.jsx("div",{className:"flex gap-2 items-center",children:e.jsx($,{rating:t[0].vote_average.toFixed(2)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{duration:t[0].runtime}),e.jsxs("p",{className:"flex items-center gap-2 text-white ",children:[e.jsx(_,{className:"text-dyellow"}),t[0].release_date.slice(0,4)]})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{children:e.jsx("p",{className:"text-white",children:t[0].genres.map(a=>a.name).join(",")})})})]}),e.jsxs("div",{className:" space-y-8 md:space-y-6 w-full md:w-[60%]",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-white font-semibold",children:"Select Date:"}),e.jsx("div",{className:" grid text-white grid-cols-5 gap-2 md:gap-3",children:k.map(a=>e.jsxs("button",{onClick:()=>f(a.dateUnix),className:`cursor-pointer ${s.unix(n).format("YYYY-MM-DD")===s.unix(a.dateUnix).format("YYYY-MM-DD")?"bg-dyellow text-black":null} flex flex-col gap-1 border-2 border-dyellow py-2 hover:bg-dyellow hover:text-black transition-all duration-300 ease-in-out rounded-md text-sm`,children:[e.jsx("span",{children:s(a.date).format("DD")}),e.jsx("span",{children:s(a.date).format("ddd")})]},a.date))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-white font-semibold",children:"Select Showtime:"}),e.jsx("div",{className:"grid text-white grid-cols-3 gap-2 md:gap-3",children:h&&h.map(a=>e.jsx("button",{disabled:P(a.showtimes),onClick:()=>{j(a.showtimes),D(a.showtimeID)},className:`border-2 border-dyellow py-2 rounded-md cursor-pointer hover:bg-dyellow hover:text-black transition-all duration-300 ease-in-out text-sm disabled:bg-gray-600 disabled:text-gray-300 disabled:cursor-not-allowed ${m===a.showtimes?"bg-dyellow text-black":null}`,children:s.unix(a.showtimes).format("hh:mm A")},a.showtimes))})]}),e.jsxs("div",{className:" w-full flex gap-4 md:gap-6",children:[e.jsxs("div",{className:"custom-select w-[40%] md:w-[25%]",children:[e.jsx("label",{htmlFor:"city",className:"block mb-2 font-semibold text-white",children:"Select City:"}),e.jsxs("select",{onChange:a=>N(a.target.value),id:"city",value:i,className:"relative focus:ring-0 bg-transparent border-2 border-dyellow rounded-md block w-full text-white text-sm  p-2.5",children:[e.jsx("option",{value:"",disabled:!0,children:"Select City"}),["Mumbai","Pune","Bengaluru","Hyderabad","Delhi"].map(a=>e.jsx("option",{className:" bg-blue text-white",value:a,children:a},a))]})]}),e.jsxs("div",{className:"custom-select w-[60%] md:w-[75%]",children:[e.jsx("label",{htmlFor:"theater",className:"block mb-2 font-semibold text-white",children:"Select Theater:"}),e.jsxs("select",{onChange:a=>v(JSON.parse(a.target.value)),value:r?JSON.stringify(r):"",id:"theater",className:"relative focus:ring-0 bg-transparent border-2 border-dyellow rounded-md block w-full text-white text-sm  p-2.5",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Theater"}),i?L[i].map(a=>e.jsxs("option",{className:" bg-blue text-white",value:JSON.stringify(a),children:["Name: ",a.name,", Location: ",a.location]},a.name)):null]})]})]}),e.jsxs("button",{disabled:i==""||r==null||m=="",onClick:M,className:"flex gap-2 items-center bg-dyellow py-3 px-8 text-sm rounded-md font-medium cursor-pointer disabled:bg-gray-600 disabled:text-gray-300 disabled:cursor-not-allowed",children:["Next ",e.jsx(F,{})]})]})]})})]})})}export{K as default};
